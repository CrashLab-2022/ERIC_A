<launch>
    <arg name="mode" default="0"/>
    <!--slam is 0, navigation is 1 -->


    <!-- master rasberry pi -->
    <arg name="set_port_lidar" default="/dev/ttyLIDAR"/>
    <!-- <arg name="set_port_imu" default="/dev/ttyIMU"/> -->
    <arg name="set_lidar_frame_id" default="base_link"/>
    <arg name="set_imu_frame_id" default="imu_link"/>

    <include file="$(find eric_a_lidar)/launch/eric_a_lidar.launch">
        <arg name="set_port" default="$(arg set_port_lidar)"/>
        <arg name="set_frame_id" default="$(arg set_lidar_frame_id)"/>
        <arg name="frequency" default="10.0"/>
    </include>

    <!-- <include file="$(find eric_a_imu)/launch/eric_a_imu.launch">
        <arg name="set_port" default="$(arg set_port_imu)"/> 
        <arg name="set_frame_id" default="$(arg set_imu_frame_id)"/>
        <arg name="frequency" default="100.0"/>
    </include> -->

    <include if="$(eval arg('mode') ==0)" file="$(find eric_a_slam)/launch/eric_a_slam.launch"/>
    <!-- mapping -->

    <include if="$(eval arg('mode') ==1)" file="$(find eric_a_navigation)/launch/eric_a_navigation"/>
    <!-- navigation -->

    <!-- remote control rasberry pi -->
    <group>
        <machine
            name="control_machine"
            address="192.168.240.52" 
            env-loader="/opt/ros/noetic/env_remote.sh"
            default="true"
            user="ubuntu"
        />
        <machine           
            name="rpi_main_machine"
            address="192.168.240.127" 
            env-loader="/opt/ros/noetic/env_remote.sh"
            default="true"
            user="ubuntu"
        />
        <machine           
            name="main_machine"
            address="192.168.240.22" 
            env-loader="/opt/ros/noetic/env_remote.sh"
            default="true"
            user="jeonghan"
        />

        <include file="$(find eric_a_bringup)/launch/eric_a_motor.launch">
            <arg name="machine" default="main_machine"/>
        </include>

        <include file="$(find eric_a_navigation)/launch/eric_a_configuration.launch">
            <arg name="machine" default="main_machine"/>
        </include>  

        <include if="$(eval arg('mode') =='1')"  file="$(find eric_a_navigation)/launch/amcl.launch">
            <arg name="machine" default="main_machine"/>
        </include>
    </group>

</launch>